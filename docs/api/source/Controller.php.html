<html>
    <head>
        <script
            type="text/javascript"
            src="../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * Master class that all other INI controllers in this package will extend.
 *
 * @author SierraKomodo
 * @license GPL3
 */


namespace SierraKomodo\INIController;


/**
 * Master class that all other INI controllers in this package will extend.
 *
 * This class handles all of the common, internal functions for the INI controller. You probably don't want to directly
 * use this class unless you're writing your own controller that extends it; Instead use one of the other classes that
 * extend this.
 *
 * @internal This class is designed for use by child classes that extend it, it is not meant to be used directly.
 * @package SierraKomodo\INIController
 * @used-by \SierraKomodo\INIController\ObjectController
 * @used-by \SierraKomodo\INIController\StaticController
 * @version 0.1.0-dev Currently in development; Not fully tested yet.
 */
class Controller
{
    /**
     * @var string $file Contains the filepath used in the last call to readFile()
     * @used-by \SierraKomodo\INIController\Controller::readFile()
     * @used-by \SierraKomodo\INIController\Controller::writeFile()
     */
    protected $file = '';
    /**
     * @var array $fileArray Array containing the output of parse_ini_file generated in the last call to readFile()
     * @used-by \SierraKomodo\INIController\Controller::readFile()
     * @used-by \SierraKomodo\INIController\Controller::writeFile()
     * @used-by \SierraKomodo\INIController\Controller::generateFile()
     */
    protected $fileArray = array();
    /**
     * @var string $fileContent Contains the output of the last call to generateFile()
     * @used-by \SierraKomodo\INIController\Controller::writeFile()
     * @used-by \SierraKomodo\INIController\Controller::generateFile()
     */
    protected $fileContent = '';
    
    
    /**
     * Reads the specified file.
     *
     * Reads the specified file, storing the file name in $this-&gt;file, output of parse_ini_file() in $this-&gt;fileArray,
     * and then running $this-&gt;generateFile() afterwards.
     *
     * @param string $parFile Full/relative path to the INI file to read. Defaults to $this-&gt;file
     * @return bool True on success
     * @throws \BadFunctionCallException If $parFile and $this-&gt;file are both null
     * @throws \RuntimeException If $this-&gt;file does not exist or is unreadable
     * @throws \RuntimeException If parse_ini_file() fails to parse $this-&gt;file
     * @uses \SierraKomodo\INIController\Controller::$file
     * @uses \SierraKomodo\INIController\Controller::$fileArray
     * @uses \SierraKomodo\INIController\Controller::generateFile()
     */
    protected function readFile($parFile = null)
    {
        if ($parFile == null) {
            $parFile = $this-&gt;file;
        }
        
        // Input validation
        if ($parFile == null) {
            throw new \BadFunctionCallException(&quot;Parameter File must not be null if no filepath has previously been defined&quot;);
        }
        if (!is_file($parFile)) {
            throw new \RuntimeException(&quot;File '{$parFile}' does not exist or is inaccessable&quot;);
        }
        if (!is_readable($parFile)) {
            throw new \RuntimeException(&quot;File '{$parFile}' is not readable&quot;);
        }
        
        // Load and attempt to parse the INI file
        $array = parse_ini_file($parFile, true);
        if ($array === false) {
            throw new \RuntimeException(&quot;Failed to parse '{$parFile}' as an INI file&quot;);
        }
        
        // Set object variables
        $this-&gt;file      = $parFile;
        $this-&gt;fileArray = $array;
        $this-&gt;generateFile();
        
        // Indicate success
        return true;
    }
    
    
    /**
     * Writes data stored in $this-&gt;fileArray into $this-&gt;file
     *
     * @param string $parFile Full/relative path to the INI file to read. Defaults to $this-&gt;file
     * @return bool True on success
     * @throws \BadFunctionCallException If $parFile and $this-&gt;file are both null
     * @throws \RuntimeException If $this-&gt;file is not writable
     * @throws \RuntimeException If file_put_contents() fails to write to $this-&gt;file
     * @uses \SierraKomodo\INIController\Controller::$file
     * @uses \SierraKomodo\INIController\Controller::$fileContent
     * @uses \SierraKomodo\INIController\Controller::generateFile()
     */
    protected function writeFile($parFile = null)
    {
        if ($parFile == null) {
            $parFile = $this-&gt;file;
        }
        
        // Input validation
        if ($parFile == null) {
            throw new \BadFunctionCallException(&quot;Parameter File must not be null if no filepath has previously been defined&quot;);
        }
        if (!is_writable($parFile)) {
            throw new \RuntimeException(&quot;File '{$parFile}' is not writable&quot;);
        }
        
        // Ensure the latest changes to content are converted to the full content string
        $this-&gt;generateFile();
        
        // Write content string to file
        if (file_put_contents($parFile, $this-&gt;fileContent) === false) {
            throw new \RuntimeException(&quot;Failed to write content to '{$parFile}'&quot;);
        }
        
        // Indicate success
        return true;
    }
    
    
    /**
     * Generates a fully formatted INI string and stores it in $this-&gt;fileContent
     *
     * @return bool True on success
     * @uses    \SierraKomodo\INIController\Controller::$fileArray
     * @uses    \SierraKomodo\INIController\Controller::$fileContent
     * @used-by \SierraKomodo\INIController\Controller::readFile()
     * @used-by \SierraKomodo\INIController\Controller::writeFile()
     */
    protected function generateFile()
    {
        $this-&gt;fileContent = '';
        
        // Convert array into formatted INI string
        foreach ($this-&gt;fileArray as $section =&gt; $block) {
            // Section header, on its own line
            $this-&gt;fileContent .= &quot;[{$section}]\r\n&quot;;
            
            // Enter each key=value pair on separate lines
            foreach ($block as $key =&gt; $value) {
                $this-&gt;fileContent .= &quot;{$key}={$value}\r\n&quot;;
            }
            
            // Blank lines between sections/at the end of the file
            $this-&gt;fileContent .= &quot;\r\n&quot;;
        }
        
        // Indicate success
        return true;
    }
}</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>